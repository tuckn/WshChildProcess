!function(){var CD,util,fso,path,os,fs,fse,objAdd,insp,obtain,isArray,isString,isSolidString,hasContent,isSameStr,unset,srrd,child_process,MODULE_TITLE,throwErrNonStr;Wsh&&Wsh.ChildProcess||(Wsh.ChildProcess={},CD=Wsh.Constants,util=Wsh.Util,fso=Wsh.FileSystemObject,path=Wsh.Path,os=Wsh.OS,fs=Wsh.FileSystem,fse=Wsh.FileSystemExtra,objAdd=Object.assign,insp=util.inspect,obtain=util.obtainPropVal,isArray=util.isArray,util.isEmpty,isString=util.isString,util.isSolidArray,isSolidString=util.isSolidString,hasContent=util.hasContent,isSameStr=util.isSameMeaning,unset=util.unset,srrd=os.surroundCmdArg,child_process=Wsh.ChildProcess,MODULE_TITLE="WshChildProcess/ChildProcess.js",throwErrNonStr=function(functionName,typeErrVal){util.throwTypeError("string",MODULE_TITLE,functionName,typeErrVal)},child_process.splitCommand=function(command){var FN="child_process.splitCommand",argsStr=(isSolidString(command)||throwErrNonStr(FN,command),"");if(0===(command=command.trim()).indexOf('"')){var posCloseDq=command.indexOf('"',1);if(-1===posCloseDq)throw new Error("Error [Failed to parse] command: "+command+"\n  at "+FN+" ("+MODULE_TITLE+")");return{mainCmd:command.slice(1,posCloseDq),argsStr:argsStr=command.length>posCloseDq?command.slice(posCloseDq+2):argsStr}}FN=command.indexOf(" ");return-1===FN?{mainCmd:command,argsStr:argsStr}:{mainCmd:command.slice(0,FN),argsStr:argsStr=command.length>FN?command.slice(FN+1):argsStr}},child_process.exec=function(command,options){var FN="child_process.exec",command=(isSolidString(command)||throwErrNonStr(FN,command),child_process.splitCommand(command)),cmdStr=command.mainCmd,command=command.argsStr,op=objAdd({shell:!0,escapes:!0,winStyle:"hidden"},options),options=obtain(options,"runsAdmin",null);unset(op,"runsAdmin");try{return!0!==options||process.isAdmin()?!1===options&&process.isAdmin()?os.Task.runTemporary(cmdStr,command,op):os.shRun(cmdStr,command,op):os.runAsAdmin(cmdStr,command,op)}catch(e){throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  cmdStr: "'+cmdStr+'"\n  args: '+insp(command))}},child_process.execSync=function(command,options){var stdioArgs,exitCode,FN="child_process.execSync",command=(isSolidString(command)||throwErrNonStr(FN,command),child_process.splitCommand(command)),cmdStr=command.mainCmd,command=command.argsStr,op=objAdd({shell:!0,escapes:!0,winStyle:"hidden"},options),runsAdmin=obtain(options,"runsAdmin",null),logStdout=(unset(op,"runsAdmin"),os.makeTmpPath("cp-execSync_stdout_",".log")),logStderr=os.makeTmpPath("cp-execSync_stderr_",".log");if(isArray(command))stdioArgs=command.concat(["1>",srrd(logStdout),"2>",srrd(logStderr)]);else{if(!isString(command))throw new Error("Error [ERR_INVALID_ARG_TYPE]\n  at "+FN+" ("+MODULE_TITLE+')\n  cmdStr: "'+cmdStr+'"\n  args: '+insp(command));stdioArgs=command+" 1>"+srrd(logStdout)+" 2>"+srrd(logStderr)}var error=!0,stdout="",stderr="";try{var retVal=!0!==runsAdmin||process.isAdmin()?!1===runsAdmin&&process.isAdmin()?os.Task.runTemporary(cmdStr,stdioArgs,op):os.shRunSync(cmdStr,stdioArgs,op):os.runAsAdmin(cmdStr,stdioArgs,op);if(obtain(options,"isDryRun",!1))return"dry-run ["+FN+"]: "+retVal;exitCode=retVal}catch(e){throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  cmdStr: "'+cmdStr+'"\n  args: '+insp(command))}try{var encoding=obtain(options,"encoding",os.cmdCodeset()),stdout=fse.ensureReadingFile(logStdout,0,{encoding:encoding}),stderr=fse.ensureReadingFile(logStderr,0,{encoding:encoding}),error=isSolidString(stderr)}catch(e){throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  cmdStr: "'+cmdStr+'"\n  args: '+insp(command))}try{fse.removeSync(logStdout),fse.removeSync(logStderr)}catch(e){throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  cmdStr: "'+cmdStr+'"\n  args: '+insp(command))}return{exitCode:exitCode,error:error,stdout:stdout,stderr:stderr}},child_process.execFile=function(file,args,options){var FN="child_process.execFile",op=(isSolidString(file)||throwErrNonStr(FN,file),objAdd({shell:!1,escapes:!1},options)),options=obtain(options,"runsAdmin",null);unset(op,"runsAdmin");try{return!0!==options||process.isAdmin()?!1===options&&process.isAdmin()?os.Task.runTemporary(file,args,op):os.shExec(file,args,op):os.runAsAdmin(file,args,op)}catch(e){throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  file: "'+file+'"\n  args: '+insp(args))}},child_process.execFileSync=function(file,args,options){var FN="child_process.execFileSync",op=(isSolidString(file)||throwErrNonStr(FN,file),objAdd({shell:!1,escapes:!1},options)),options=obtain(options,"runsAdmin",null);unset(op,"runsAdmin");try{return!0!==options||process.isAdmin()?!1===options&&process.isAdmin()?os.Task.runTemporary(file,args,op):os.shExecSync(file,args,op):os.runAsAdmin(file,args,op)}catch(e){throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  file: "'+file+'"\n  args: '+insp(args))}},child_process.spawnSync=function(command,options){var FN="child_process.spawnSync",exeObj=(isSolidString(command)||throwErrNonStr(FN,command),child_process.splitCommand(command));try{return os.shExecSync(exeObj.mainCmd,exeObj.argsStr,objAdd({shell:!1},options))}catch(e){throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  command: "'+command+'"')}},child_process.execFileViaJSON=function(jsonPath,options){var assoc=fse.readJsonSync(jsonPath,options);if(!hasContent(assoc))throw new Error("Error: The content of the JSON file is empy\n  at child_process.execFileViaJSON ("+MODULE_TITLE+")\n  jsonPath: "+insp(jsonPath)+"\n  options: "+insp(options));var retVal=child_process.execFileSync(assoc.file,assoc.args,assoc.options);if(obtain(options,"isDryRun",!1))return"dry-run [child_process.execFileViaJSON]: "+retVal;fse.writeJsonSync(jsonPath,Object.assign(assoc,retVal),options)},child_process.isRunningAsAdmin=function(processName){if(isSameStr(process.env.USERNAME,"administrator")||!os.hasUAC()||os.isUacDisable())return!0;processName=os.WMI.getProcess(processName);if(!process.isAdmin())return hasContent(processName)?!hasContent(processName.ExecutablePath):undefined;var tmpJsPath=os.makeTmpPath("isRunningAsAdmin-",".js"),processName='var W = WScript;var E = new Enumerator(W.CreateObject("WbemScripting.SWbemLocator").ConnectServer(null, "root\\\\CIMV2").ExecQuery("SELECT * FROM Win32_Process WHERE ProcessID='+processName.ProcessID+'"));var ws = [];while (!E.atEnd()) { ws.push(E.item()); E.moveNext(); }if (ws.length === 0) W.Quit(1);var ps = new Enumerator(ws[0].Properties_); var p;while (!ps.atEnd()) {p = ps.item(); if (p.Name === "ExecutablePath") {W.Echo(p.Value); W.Quit(0); } ps.moveNext(); }W.Quit();',tmpJs=fso.CreateTextFile(tmpJsPath),processName=(tmpJs.Write(processName),tmpJs.Close(),child_process.execFileSync(os.exefiles.cscript,["//nologo",tmpJsPath],{encoding:os.cmdCodeset(),winStyle:"hidden",runsAdmin:!1}));return fso.DeleteFile(tmpJsPath,CD.fso.force.yes),hasContent(processName.stdout)?!!/^null/.test(processName.stdout)||!path.isAbsolute(processName.stdout.trim())&&void 0:undefined},child_process.writeProcessPropsToJson=function(processName,jsonPath){return fse.writeJsonSync(jsonPath,os.getProcessObj(processName))},child_process.registerTaskForExecutingHighWIL=function(){},child_process.setExePath=function(setVar,req32,req64,exePath){if(hasContent(exePath)?setVar=exePath:setVar!==undefined&&(setVar=path.join(__dirname,path.parse(setVar).base),fs.statSync(setVar).isFile()||(setVar=hasContent(req64)&&os.is64arch()?fse.findRequiredFile(req64):fse.findRequiredFile(req32))),hasContent(setVar))return setVar;throw new Error("Error: Failed to find the path\n  at child_process.setExePath ("+MODULE_TITLE+")\n  req64: "+insp(req64)+"\n  exePath: "+insp(exePath))})}();
